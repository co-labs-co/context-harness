(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3883:function(e,t,s){Promise.resolve().then(s.bind(s,7938))},7938:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eb}});var a=s(7437),r=s(2265),n=s(1239),o=s(5302),l=s(2252),c=s(9334),i=s(9397),d=s(1723),m=s(3781),x=s(2438),u=s(8768);let h={active:{icon:(0,a.jsx)(n.Z,{className:"w-3.5 h-3.5"}),color:"text-neon-cyan",label:"Active"},completed:{icon:(0,a.jsx)(o.Z,{className:"w-3.5 h-3.5"}),color:"text-emerald-400",label:"Complete"},blocked:{icon:(0,a.jsx)(l.Z,{className:"w-3.5 h-3.5"}),color:"text-amber",label:"Blocked"},archived:{icon:(0,a.jsx)(c.Z,{className:"w-3.5 h-3.5"}),color:"text-content-tertiary",label:"Archived"}},p=(0,r.forwardRef)(function(e,t){let{sessions:s,activeSession:n,loading:o,onSelectSession:l,onCreateSession:c,showNewSessionForm:p=!1,onToggleNewSession:b,isMobile:f=!1}=e,[g,y]=(0,r.useState)(""),[j,N]=(0,r.useState)(!1),v=(0,r.useRef)(null);(0,r.useImperativeHandle)(t,()=>({focusNewSession:()=>{null==b||b(!0),setTimeout(()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.focus()},100)}})),(0,r.useEffect)(()=>{p&&setTimeout(()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.focus()},100)},[p]);let w=async()=>{if(g.trim()&&!j){N(!0);try{await c(g.trim()),y(""),null==b||b(!1)}finally{N(!1)}}},k=()=>{y(""),null==b||b(!1)},S=e=>{try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}},C=e=>h[e]||h.active;return(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsx)("div",{className:"p-4",children:p?(0,a.jsxs)("div",{className:"space-y-3 animate-in",children:[(0,a.jsx)("input",{ref:v,type:"text",value:g,onChange:e=>y(e.target.value),onKeyDown:e=>{"Enter"===e.key&&w(),"Escape"===e.key&&k()},placeholder:"session-name...",disabled:j,className:"w-full px-4 py-3 border border-edge-medium rounded-xl  bg-surface-tertiary text-content-primary font-mono text-sm focus:ring-2 focus:ring-neon-cyan/50 focus:border-neon-cyan/50 placeholder:text-content-tertiary transition-all outline-none disabled:opacity-50"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:w,disabled:!g.trim()||j,className:"flex-1 px-4 py-2.5 bg-neon-cyan text-surface-primary rounded-xl hover:shadow-glow transition-all text-sm font-semibold active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Creating...":"Create"}),(0,a.jsx)("button",{onClick:k,disabled:j,className:"px-4 py-2.5 text-content-secondary rounded-xl border border-edge-subtle hover:border-edge-medium  hover:bg-surface-tertiary transition-all text-sm disabled:opacity-50",children:"Cancel"})]})]}):(0,a.jsxs)("button",{onClick:()=>null==b?void 0:b(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-3 border border-dashed border-edge-medium rounded-xl text-content-secondary hover:text-neon-cyan hover:border-neon-cyan/50 hover:bg-neon-cyan/5 transition-all group",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 group-hover:rotate-90 transition-transform duration-200"}),(0,a.jsx)("span",{className:"font-medium",children:"New Session"}),!f&&(0,a.jsx)("kbd",{className:"ml-2 px-1.5 py-0.5 bg-surface-tertiary border border-edge-subtle rounded text-[10px] font-mono text-content-tertiary",children:"⌘N"})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto px-3 pb-4",children:o?(0,a.jsx)("div",{className:"space-y-3 p-2",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"p-4 rounded-xl bg-surface-tertiary shimmer h-20"},e))}):0===s.length?(0,a.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-surface-tertiary border border-edge-subtle  flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(d.Z,{className:"w-7 h-7 text-content-tertiary"})}),(0,a.jsx)("p",{className:"text-content-secondary text-sm",children:"No sessions yet"}),(0,a.jsx)("p",{className:"text-content-tertiary text-xs mt-1",children:f?"Tap the button above to create one":"Press ⌘+N to create one"})]}):(0,a.jsx)("div",{className:"space-y-2",children:s.map((e,t)=>{var s,r,o;let c=C(e.status),i=(null==n?void 0:n.id)===e.id,d=e.github&&(e.github.branch||e.github.issue||e.github.pr);return(0,a.jsxs)("button",{onClick:()=>l(e),className:"w-full text-left p-4 rounded-xl transition-all hover-lift\n                    ".concat(i?"bg-surface-elevated border border-neon-cyan/30 shadow-glow-sm":"bg-surface-secondary/50 border border-transparent hover:bg-surface-tertiary hover:border-edge-subtle"),style:{animationDelay:"".concat(50*t,"ms")},children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"".concat(c.color),children:c.icon}),(0,a.jsx)("span",{className:"font-medium truncate ".concat(i?"text-content-primary":"text-content-secondary"),children:e.name}),t<9&&(0,a.jsxs)("kbd",{className:"px-1 py-0.5 bg-surface-tertiary/50 border border-edge-subtle/50  rounded text-[9px] font-mono text-content-tertiary opacity-0  group-hover:opacity-100 transition-opacity",children:["⌘",t+1]})]}),e.active_work&&(0,a.jsx)("p",{className:"text-xs text-content-tertiary mt-1.5 truncate pl-5",children:e.active_work})]}),i&&(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-neon-cyan animate-pulse"})]}),d&&(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2.5 pl-5",children:[(null===(s=e.github)||void 0===s?void 0:s.branch)&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs text-content-tertiary",children:[(0,a.jsx)(m.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{className:"font-mono truncate max-w-[80px]",children:e.github.branch})]}),(null===(r=e.github)||void 0===r?void 0:r.issue)&&(0,a.jsxs)("a",{href:e.github.issue.url||"#",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"flex items-center gap-1 text-xs text-violet hover:text-violet/80 transition-colors",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:e.github.issue.number||"Issue"})]}),(null===(o=e.github)||void 0===o?void 0:o.pr)&&(0,a.jsxs)("a",{href:e.github.pr.url||"#",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"flex items-center gap-1 text-xs text-emerald-400 hover:text-emerald-300 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:e.github.pr.number||"PR"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 pl-5",children:[(0,a.jsxs)("span",{className:"text-xs text-content-tertiary font-mono",children:["cycle #",e.compaction_cycle]}),(0,a.jsx)("span",{className:"text-xs text-content-tertiary",children:S(e.updated_at)})]})]},e.id)})})})]})});var b=s(236),f=s(5561),g=s(401),y=s(8867),j=s(5863),N=s(6901),v=s(5131),w=s(875),k=s(407),S=s(4972),C=s(3276),Z=s(5554),D=s(6362),E=s(2222),_=s(2369),T=s(3639),O=s(9525),F=s(4743),I=s(730),R=s(8662);function P(e){let{onTranscription:t}=e,[s,n]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!0),[c,i]=(0,r.useState)(""),d=(0,r.useRef)(null);return((0,r.useEffect)(()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e){l(!1);return}let s=new e;return s.continuous=!0,s.interimResults=!0,s.lang="en-US",s.onresult=e=>{let s="",a="";for(let t=e.resultIndex;t<e.results.length;t++){let r=e.results[t][0].transcript;e.results[t].isFinal?s+=r:a+=r}s?(t(s),i("")):i(a)},s.onerror=e=>{console.error("Speech recognition error:",e.error),n(!1),i("")},s.onend=()=>{n(!1),i("")},d.current=s,()=>{s.abort()}},[t]),o)?(0,a.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,a.jsxs)("button",{onClick:()=>{d.current&&(s?(d.current.stop(),n(!1)):(d.current.start(),n(!0)))},className:"p-3 md:p-4 rounded-xl md:rounded-2xl transition-all relative overflow-hidden\n          ".concat(s?"bg-amber/20 text-amber border border-amber/50 shadow-[0_0_20px_-5px_rgba(255,184,0,0.5)]":"bg-surface-tertiary text-content-secondary border border-edge-subtle hover:border-edge-medium hover:text-content-primary hover:bg-surface-elevated"),title:s?"Stop recording":"Start voice input",children:[(0,a.jsx)(R.Z,{className:"w-5 h-5 relative z-10 ".concat(s?"animate-pulse":"")}),s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"absolute inset-0 rounded-xl md:rounded-2xl border-2 border-amber/50 pulse-ring"}),(0,a.jsx)("span",{className:"absolute inset-0 rounded-xl md:rounded-2xl border-2 border-amber/30 pulse-ring",style:{animationDelay:"0.5s"}})]})]}),s&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-amber rounded-full  shadow-[0_0_10px_2px_rgba(255,184,0,0.6)]",children:(0,a.jsx)("span",{className:"absolute inset-0 rounded-full bg-amber animate-ping opacity-75"})}),c&&(0,a.jsxs)("div",{className:"absolute bottom-full right-0 mb-3 p-3 rounded-xl max-w-[200px] md:max-w-xs bg-surface-elevated border border-edge-medium shadow-glow-sm animate-in z-10",children:[(0,a.jsx)("span",{className:"text-content-tertiary text-xs font-medium",children:"Hearing:"}),(0,a.jsx)("p",{className:"text-content-primary text-sm mt-1 break-words",children:c})]})]}):(0,a.jsx)("button",{disabled:!0,className:"p-3 md:p-4 text-content-tertiary rounded-xl md:rounded-2xl cursor-not-allowed  bg-surface-tertiary border border-edge-subtle opacity-50 flex-shrink-0",title:"Voice input not supported in this browser",children:(0,a.jsx)(I.Z,{className:"w-5 h-5"})})}var H=s(4822);let L={"github-copilot":"text-violet",google:"text-blue-400",openrouter:"text-emerald-400",opencode:"text-neon-cyan"},z={"github-copilot":"GitHub Copilot",google:"Google",openrouter:"OpenRouter",opencode:"OpenCode"};function K(e){let{sessionId:t,onModelChange:s,compact:n=!1}=e,[o,l]=(0,r.useState)([]),[c,i]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1),[b,f]=(0,r.useState)(null),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{N(),v()},[t]),(0,r.useEffect)(()=>{function e(e){y.current&&!y.current.contains(e.target)&&m(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let N=async()=>{try{let e=await fetch("/api/chat/models");if(e.ok){let t=await e.json();l(t.models||[]),t.current_model&&!c&&i(t.current_model)}else f("Failed to load models")}catch(e){console.error("Failed to fetch models:",e),f("Failed to load models")}finally{u(!1)}},v=async()=>{try{let e=await fetch("/api/chat/".concat(t,"/model"));if(e.ok){let t=await e.json();t.model_id&&i(t.model_id)}}catch(e){console.error("Failed to fetch current model:",e)}},k=async e=>{if(e===c){m(!1);return}p(!0),m(!1);try{let a=await fetch("/api/chat/".concat(t,"/model"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_id:e})});if(a.ok){let t=await a.json();t.success?(i(e),null==s||s(e)):f(t.message||"Failed to set model")}else f("Failed to set model")}catch(e){console.error("Failed to set model:",e),f("Failed to set model")}finally{p(!1)}},S=o.reduce((e,t)=>(e[t.provider]||(e[t.provider]=[]),e[t.provider].push(t),e),{}),C=o.find(e=>e.id===c),Z=(null==C?void 0:C.name)||(null==c?void 0:c.split("/")[1])||"Select model",D=C&&L[C.provider]||"text-content-secondary";return x?(0,a.jsxs)("div",{className:"flex items-center gap-1.5 ".concat(n?"text-xs":"text-sm"," text-content-tertiary"),children:[(0,a.jsx)(j.Z,{className:"w-3 h-3 animate-spin"}),(0,a.jsx)("span",{children:"Loading..."})]}):(0,a.jsxs)("div",{className:"relative",ref:y,children:[(0,a.jsxs)("button",{onClick:()=>m(!d),disabled:h,className:"\n          flex items-center gap-1.5 px-2 py-1 rounded-lg\n          border border-edge-subtle bg-surface-secondary\n          hover:bg-surface-tertiary hover:border-edge-medium\n          transition-all cursor-pointer\n          ".concat(n?"text-xs":"text-sm","\n          ").concat(h?"opacity-50 cursor-wait":"","\n        "),children:[h?(0,a.jsx)(j.Z,{className:"w-3 h-3 animate-spin text-neon-cyan"}):(0,a.jsx)(H.Z,{className:"w-3 h-3 ".concat(D)}),(0,a.jsx)("span",{className:"text-content-secondary max-w-[150px] truncate",children:Z}),(0,a.jsx)(w.Z,{className:"w-3 h-3 text-content-tertiary transition-transform ".concat(d?"rotate-180":"")})]}),d&&(0,a.jsxs)("div",{className:"absolute top-full mt-1 right-0 z-50 min-w-[280px] max-h-[400px] overflow-y-auto bg-surface-elevated border border-edge-subtle rounded-xl shadow-2xl",children:[Object.entries(S).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-content-tertiary bg-surface-tertiary/50 sticky top-0",children:z[t]||t}),s.map(e=>(0,a.jsxs)("button",{onClick:()=>k(e.id),className:"\n                    w-full flex items-center gap-2 px-3 py-2 text-left text-sm\n                    hover:bg-surface-tertiary transition-colors\n                    ".concat(e.id===c?"bg-neon-cyan/10":"","\n                  "),children:[(0,a.jsx)(H.Z,{className:"w-3.5 h-3.5 flex-shrink-0 ".concat(L[t]||"text-content-secondary")}),(0,a.jsx)("span",{className:"flex-1 truncate text-content-secondary",children:e.name}),e.id===c&&(0,a.jsx)(g.Z,{className:"w-4 h-4 text-neon-cyan flex-shrink-0"})]},e.id))]},t)}),0===o.length&&(0,a.jsxs)("div",{className:"px-3 py-4 text-sm text-content-tertiary text-center",children:["No models available.",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-xs",children:"Make sure OpenCode is running."})]})]}),b&&(0,a.jsxs)("div",{className:"absolute top-full mt-1 right-0 z-50 px-3 py-2 bg-rose-500/20 border border-rose-500/30 rounded-lg text-xs text-rose-400",children:[b,(0,a.jsx)("button",{onClick:()=>f(null),className:"ml-2 text-rose-300 hover:text-rose-100",children:"\xd7"})]})]})}var A=s(6475),W=s(7586),G=s(8736),U=s(4794),M=s(8930),q=s(9076),J=s(8728),V=s(112),X=s(3247),B=s(4935),Q=s(3417),$=s(221);let Y=[{command:"/ctx",description:"Switch to or create a ContextHarness session",category:"context-harness",args:"<session-name>",icon:(0,a.jsx)(A.Z,{className:"w-4 h-4"})},{command:"/contexts",description:"List all available ContextHarness sessions",category:"context-harness",icon:(0,a.jsx)(W.Z,{className:"w-4 h-4"})},{command:"/baseline",description:"Generate PROJECT-CONTEXT.md through analysis",category:"context-harness",args:"[--flags]",icon:(0,a.jsx)(G.Z,{className:"w-4 h-4"})},{command:"/compact",description:"Manually trigger context compaction",category:"context-harness",icon:(0,a.jsx)(U.Z,{className:"w-4 h-4"})},{command:"/model",description:"Switch to a different AI model",category:"opencode",args:"<provider/model>",icon:(0,a.jsx)(H.Z,{className:"w-4 h-4"})},{command:"/agent",description:"Switch to a different agent mode",category:"opencode",args:"<agent-name>",icon:(0,a.jsx)(n.Z,{className:"w-4 h-4"})},{command:"/issue",description:"Create or link a GitHub issue",category:"opencode",args:"[number|url]",icon:(0,a.jsx)(m.Z,{className:"w-4 h-4"})},{command:"/pr",description:"Create or view a pull request",category:"opencode",args:"[number]",icon:(0,a.jsx)(u.Z,{className:"w-4 h-4"})},{command:"/clear",description:"Clear the current conversation",category:"opencode",icon:(0,a.jsx)(M.Z,{className:"w-4 h-4"})},{command:"/retry",description:"Retry the last message",category:"opencode",icon:(0,a.jsx)(q.Z,{className:"w-4 h-4"})},{command:"/config",description:"View or modify configuration",category:"opencode",args:"[key] [value]",icon:(0,a.jsx)(J.Z,{className:"w-4 h-4"})},{command:"/help",description:"Show available commands",category:"opencode",icon:(0,a.jsx)(V.Z,{className:"w-4 h-4"})},{command:"/search",description:"Search the codebase",category:"opencode",args:"<query>",icon:(0,a.jsx)(X.Z,{className:"w-4 h-4"})},{command:"/diff",description:"Show git diff",category:"opencode",args:"[file]",icon:(0,a.jsx)(B.Z,{className:"w-4 h-4"})},{command:"/status",description:"Show git status",category:"opencode",icon:(0,a.jsx)(m.Z,{className:"w-4 h-4"})},{command:"/commit",description:"Create a git commit",category:"opencode",args:"[message]",icon:(0,a.jsx)(Q.Z,{className:"w-4 h-4"})}],ee={"context-harness":{label:"ContextHarness",color:"text-neon-cyan",bgColor:"bg-neon-cyan/10",borderColor:"border-neon-cyan/30"},opencode:{label:"OpenCode",color:"text-violet",bgColor:"bg-violet/10",borderColor:"border-violet/30"},general:{label:"General",color:"text-content-secondary",bgColor:"bg-surface-tertiary",borderColor:"border-edge-subtle"}};function et(e){let{suggestions:t,selectedIndex:s,onSelect:n,onHover:o}=e,l=(0,r.useRef)(null);if((0,r.useEffect)(()=>{if(l.current){let e=l.current.querySelector('[data-index="'.concat(s,'"]'));e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}},[s]),0===t.length)return null;let c=t.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{});return(0,a.jsx)("div",{ref:l,className:"absolute bottom-full left-0 right-0 mb-2 max-h-[300px] overflow-y-auto bg-surface-elevated border border-edge-subtle rounded-xl shadow-2xl z-50",children:(0,a.jsxs)("div",{className:"p-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 text-xs text-content-tertiary mb-1",children:[(0,a.jsx)($.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Slash Commands"}),(0,a.jsx)("span",{className:"ml-auto text-[10px]",children:"↑↓ navigate • Enter select • Esc close"})]}),Object.entries(c).map(e=>{let[r,l]=e,c=ee[r];return(0,a.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,a.jsx)("div",{className:"px-2 py-1 text-[10px] font-semibold ".concat(c.color," uppercase tracking-wider"),children:c.label}),l.map(e=>{let r=t.indexOf(e),l=r===s;return(0,a.jsxs)("button",{"data-index":r,onClick:()=>n(e),onMouseEnter:()=>o(r),className:"\n                      w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left\n                      transition-colors cursor-pointer\n                      ".concat(l?"".concat(c.bgColor," ").concat(c.borderColor," border"):"hover:bg-surface-tertiary border border-transparent","\n                    "),children:[(0,a.jsx)("span",{className:"flex-shrink-0 ".concat(c.color),children:e.icon}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-mono font-medium ".concat(l?c.color:"text-content-primary"),children:e.command}),e.args&&(0,a.jsx)("span",{className:"text-xs text-content-tertiary font-mono",children:e.args})]}),(0,a.jsx)("p",{className:"text-xs text-content-tertiary truncate",children:e.description})]})]},e.command)})]},r)})]})})}function es(e){let{value:t,className:s=""}=e,r=[],n=t.match(/^(\/\w+)(\s.*)?$/);if(n){let[,e,t]=n,s=Y.find(t=>t.command===e),o=s?ee[s.category]:ee.general;r.push((0,a.jsx)("span",{className:"font-mono font-semibold ".concat(o.color),children:e},"cmd")),t&&r.push((0,a.jsx)("span",{className:"text-content-primary",children:t},"rest"))}else r.push((0,a.jsx)("span",{children:t},"text"));return(0,a.jsx)("div",{className:"pointer-events-none whitespace-pre-wrap break-words ".concat(s),children:r})}function ea(e){let{text:t,className:s=""}=e,[n,o]=(0,r.useState)(!1),l=async e=>{e.stopPropagation();try{await navigator.clipboard.writeText(t),o(!0),setTimeout(()=>o(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return(0,a.jsx)("button",{onClick:l,className:"p-1.5 rounded-lg transition-all hover:bg-white/10 ".concat(s),title:n?"Copied!":"Copy message",children:n?(0,a.jsx)(g.Z,{className:"w-3.5 h-3.5 text-emerald-400"}):(0,a.jsx)(y.Z,{className:"w-3.5 h-3.5 text-content-tertiary hover:text-content-secondary"})})}function er(e){let{content:t}=e,s=t.replace(/\n{4,}/g,"\n\n\n").trim();return(0,a.jsx)(b.UG,{remarkPlugins:[f.Z],components:{h1:e=>{let{children:t}=e;return(0,a.jsx)("h1",{className:"text-xl font-bold mt-4 mb-2 text-content-primary",children:t})},h2:e=>{let{children:t}=e;return(0,a.jsx)("h2",{className:"text-lg font-semibold mt-3 mb-2 text-content-primary",children:t})},h3:e=>{let{children:t}=e;return(0,a.jsx)("h3",{className:"text-base font-semibold mt-2 mb-1 text-content-primary",children:t})},p:e=>{let{children:t}=e;return(0,a.jsx)("p",{className:"mb-2 last:mb-0 leading-relaxed",children:t})},a:e=>{let{href:t,children:s}=e;return(0,a.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-neon-cyan hover:underline",children:s})},code:e=>{let{className:t,children:s}=e;return t?(0,a.jsx)("code",{className:"block p-3 my-2 bg-surface-tertiary rounded-lg text-sm font-mono overflow-x-auto",children:s}):(0,a.jsx)("code",{className:"px-1.5 py-0.5 bg-surface-tertiary rounded text-sm font-mono text-neon-cyan",children:s})},pre:e=>{let{children:t}=e;return(0,a.jsx)("pre",{className:"my-2",children:t})},ul:e=>{let{children:t}=e;return(0,a.jsx)("ul",{className:"list-disc list-inside mb-2 space-y-1",children:t})},ol:e=>{let{children:t}=e;return(0,a.jsx)("ol",{className:"list-decimal list-inside mb-2 space-y-1",children:t})},li:e=>{let{children:t}=e;return(0,a.jsx)("li",{className:"text-content-secondary",children:t})},blockquote:e=>{let{children:t}=e;return(0,a.jsx)("blockquote",{className:"border-l-2 border-neon-cyan/50 pl-3 my-2 text-content-secondary italic",children:t})},table:e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"overflow-x-auto my-2",children:(0,a.jsx)("table",{className:"min-w-full border border-edge-subtle rounded-lg overflow-hidden",children:t})})},thead:e=>{let{children:t}=e;return(0,a.jsx)("thead",{className:"bg-surface-tertiary",children:t})},tbody:e=>{let{children:t}=e;return(0,a.jsx)("tbody",{className:"divide-y divide-edge-subtle",children:t})},tr:e=>{let{children:t}=e;return(0,a.jsx)("tr",{className:"hover:bg-white/5",children:t})},th:e=>{let{children:t}=e;return(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-content-secondary",children:t})},td:e=>{let{children:t}=e;return(0,a.jsx)("td",{className:"px-3 py-2 text-sm",children:t})},hr:()=>(0,a.jsx)("hr",{className:"my-4 border-edge-subtle"}),strong:e=>{let{children:t}=e;return(0,a.jsx)("strong",{className:"font-semibold text-content-primary",children:t})},em:e=>{let{children:t}=e;return(0,a.jsx)("em",{className:"italic",children:t})}},children:s})}function en(e){let{toolCall:t}=e,[s,n]=(0,r.useState)(!1),o={pending:(0,a.jsx)(d.Z,{className:"w-3 h-3 text-content-tertiary"}),in_progress:(0,a.jsx)(j.Z,{className:"w-3 h-3 text-neon-cyan animate-spin"}),completed:(0,a.jsx)(N.Z,{className:"w-3 h-3 text-emerald-400"}),failed:(0,a.jsx)(v.Z,{className:"w-3 h-3 text-rose-400"})}[t.status],l={pending:"border-content-tertiary/30",in_progress:"border-neon-cyan/50 bg-neon-cyan/5",completed:"border-emerald-400/30 bg-emerald-400/5",failed:"border-rose-400/30 bg-rose-400/5"}[t.status],c={read:"\uD83D\uDCD6",edit:"✏️",delete:"\uD83D\uDDD1️",execute:"▶️",search:"\uD83D\uDD0D",fetch:"\uD83C\uDF10",think:"\uD83E\uDDE0",other:"\uD83D\uDD27"}[t.kind||"other"]||"\uD83D\uDD27";return(0,a.jsxs)("div",{className:"mt-2 rounded-lg border ".concat(l," overflow-hidden transition-all"),children:[(0,a.jsxs)("button",{onClick:()=>n(!s),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-left hover:bg-white/5 transition-colors",children:[s?(0,a.jsx)(w.Z,{className:"w-3 h-3 text-content-tertiary flex-shrink-0"}):(0,a.jsx)(k.Z,{className:"w-3 h-3 text-content-tertiary flex-shrink-0"}),(0,a.jsx)("span",{className:"flex-shrink-0",children:c}),(0,a.jsx)("span",{className:"flex-1 font-medium text-content-secondary truncate",children:t.title}),o]}),s&&(0,a.jsx)("div",{className:"px-3 pb-2 text-xs text-content-tertiary border-t border-edge-subtle/50",children:(0,a.jsxs)("div",{className:"pt-2 space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-content-tertiary",children:"ID:"})," ",(0,a.jsx)("span",{className:"font-mono",children:t.id})]}),t.kind&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-content-tertiary",children:"Kind:"})," ",t.kind]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-content-tertiary",children:"Status:"})," ",t.status]})]})})]})}function eo(e){let{thoughts:t}=e,[s,n]=(0,r.useState)(!1);return 0===t.length?null:(0,a.jsxs)("div",{className:"mt-2 rounded-lg border border-violet/30 bg-violet/5 overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>n(!s),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-left hover:bg-violet/10 transition-colors",children:[s?(0,a.jsx)(w.Z,{className:"w-3 h-3 text-violet flex-shrink-0"}):(0,a.jsx)(k.Z,{className:"w-3 h-3 text-violet flex-shrink-0"}),(0,a.jsx)(S.Z,{className:"w-3 h-3 text-violet flex-shrink-0"}),(0,a.jsxs)("span",{className:"flex-1 font-medium text-violet",children:["Agent Thoughts (",t.length,")"]})]}),s&&(0,a.jsx)("div",{className:"px-3 pb-2 text-xs text-content-secondary border-t border-violet/20",children:(0,a.jsx)("div",{className:"pt-2 space-y-2",children:t.map((e,t)=>(0,a.jsx)("p",{className:"italic text-violet/80",children:e},t))})})]})}function el(e){let{plan:t}=e,[s,n]=(0,r.useState)(!0);if(0===t.length)return null;let o={high:"text-rose-400",medium:"text-amber",low:"text-content-tertiary"},l={pending:(0,a.jsx)(d.Z,{className:"w-3 h-3 text-content-tertiary"}),in_progress:(0,a.jsx)(C.Z,{className:"w-3 h-3 text-neon-cyan"}),completed:(0,a.jsx)(N.Z,{className:"w-3 h-3 text-emerald-400"})};return(0,a.jsxs)("div",{className:"mt-2 rounded-lg border border-amber/30 bg-amber/5 overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>n(!s),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-left hover:bg-amber/10 transition-colors",children:[s?(0,a.jsx)(w.Z,{className:"w-3 h-3 text-amber flex-shrink-0"}):(0,a.jsx)(k.Z,{className:"w-3 h-3 text-amber flex-shrink-0"}),(0,a.jsx)(Z.Z,{className:"w-3 h-3 text-amber flex-shrink-0"}),(0,a.jsxs)("span",{className:"flex-1 font-medium text-amber",children:["Plan (",t.filter(e=>"completed"===e.status).length,"/",t.length,")"]})]}),s&&(0,a.jsx)("div",{className:"px-3 pb-2 text-xs border-t border-amber/20",children:(0,a.jsx)("ul",{className:"pt-2 space-y-1.5",children:t.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[l[e.status],(0,a.jsx)("span",{className:"flex-1 ".concat("completed"===e.status?"line-through text-content-tertiary":"text-content-secondary"),children:e.content}),(0,a.jsx)("span",{className:"text-[10px] ".concat(o[e.priority]),children:e.priority})]},t))})})]})}function ec(e){var t,s;let{session:n,onError:o,isMobile:l=!1}=e,[c,i]=(0,r.useState)([]),[d,h]=(0,r.useState)(""),[p,b]=(0,r.useState)(!1),[f,g]=(0,r.useState)(!1),y=(0,r.useRef)(null),N=(0,r.useRef)(null),v=function(e){let[t,s]=(0,r.useState)([]),[a,n]=(0,r.useState)(!1),[o,l]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(e.startsWith("/")){let t=e.toLowerCase(),a=Y.filter(e=>e.command.toLowerCase().startsWith(t)||e.description.toLowerCase().includes(t.slice(1)));s(a),n(a.length>0),l(0)}else s([]),n(!1)},[e]);let c=(0,r.useCallback)(()=>{l(e=>(e+1)%t.length)},[t.length]),i=(0,r.useCallback)(()=>{l(e=>(e-1+t.length)%t.length)},[t.length]),d=(0,r.useCallback)(()=>t[o],[t,o]);return{suggestions:t,isActive:a,selectedIndex:o,setSelectedIndex:l,selectNext:c,selectPrev:i,getSelected:d}}(d);(0,r.useEffect)(()=>{w()},[n.id]),(0,r.useEffect)(()=>{var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[c]);let w=async()=>{try{let e=await fetch("/api/chat/".concat(n.id,"/messages"));if(e.ok){let t=await e.json();i(t.messages)}else null==o||o("Failed to load messages")}catch(e){console.error("Failed to fetch messages:",e),null==o||o("Failed to fetch messages")}},k=async()=>{if(!d.trim()||p)return;let e={id:"temp-".concat(Date.now()),role:"user",content:d,timestamp:new Date().toISOString()};i(t=>[...t,e]),h(""),b(!0),g(!0);try{var t;let s=await fetch("/api/chat/".concat(n.id,"/stream"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:n.id,content:e.content})});if(!s.ok)throw Error("Failed to send message");let a=null===(t=s.body)||void 0===t?void 0:t.getReader(),r=new TextDecoder,l={id:"assistant-".concat(Date.now()),role:"assistant",content:"",timestamp:new Date().toISOString(),status:"streaming",toolCalls:[],thoughts:[],plan:[]};i(e=>[...e,l]);let c="";for(;a;){let{done:t,value:s}=await a.read();if(t)break;c+=r.decode(s,{stream:!0});let n=function(e){let t=[],s=e.split("\n"),a=null,r=null;for(let e of s)if(e.startsWith("event: "))a=e.slice(7).trim();else if(e.startsWith("data: "))r=e.slice(6);else if(""===e&&a&&r){try{let e=JSON.parse(r);t.push({type:a,data:e})}catch(e){console.warn("Failed to parse SSE data:",r)}a=null,r=null}return t}(c),d=c.lastIndexOf("\n\n");for(let t of(-1!==d&&(c=c.slice(d+2)),n))switch(t.type){case"user_message":t.data.id&&i(s=>s.map(s=>s.id===e.id?{...s,id:t.data.id}:s));break;case"start":t.data.id&&(l={...l,id:t.data.id},i(e=>e.map(e=>"streaming"===e.status&&"assistant"===e.role?{...e,id:t.data.id}:e)));break;case"chunk":t.data.content&&(l={...l,content:l.content+t.data.content},i(e=>e.map(e=>e.id===l.id?l:e)));break;case"thought":t.data.content&&(l={...l,thoughts:[...l.thoughts||[],t.data.content]},i(e=>e.map(e=>e.id===l.id?l:e)));break;case"tool_call":let s={id:t.data.id,title:t.data.title,kind:t.data.kind,status:t.data.status||"pending"};l={...l,toolCalls:[...l.toolCalls||[],s]},i(e=>e.map(e=>e.id===l.id?l:e));break;case"tool_call_update":t.data.id&&(l={...l,toolCalls:(l.toolCalls||[]).map(e=>e.id===t.data.id?{...e,status:t.data.status||e.status,title:t.data.title||e.title}:e)},i(e=>e.map(e=>e.id===l.id?l:e)));break;case"plan":if(t.data.entries){let e=t.data.entries;l={...l,plan:e},i(e=>e.map(e=>e.id===l.id?l:e))}break;case"error":let a=t.data.error||"Unknown error";null==o||o(a),l={...l,content:l.content+"\n\n⚠️ Error: ".concat(a)},i(e=>e.map(e=>e.id===l.id?l:e));break;case"complete":l={...l,status:"complete",content:t.data.content||l.content},i(e=>e.map(e=>e.id===l.id?l:e));break;case"mode_change":console.log("Mode changed to:",t.data.modeId)}}i(e=>e.map(e=>e.id===l.id?{...e,status:"complete"}:e))}catch(t){console.error("Failed to send message:",t);let e="Failed to get response. Please try again.";null==o||o(e),i(t=>[...t,{id:"error-".concat(Date.now()),role:"system",content:e,timestamp:new Date().toISOString()}])}finally{b(!1),g(!1)}},S=(0,r.useCallback)(e=>{var t;h(e.args?"".concat(e.command," "):e.command),null===(t=N.current)||void 0===t||t.focus()},[]),C=e=>{try{return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch(e){return""}};return(0,a.jsxs)("div",{className:"flex-1 flex flex-col h-full min-h-0",children:[!l&&(0,a.jsx)("div",{className:"p-4 border-b border-edge-subtle glass-panel flex-shrink-0",children:(0,a.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("h2",{className:"font-semibold text-content-primary flex items-center gap-2",children:[(0,a.jsx)("span",{className:"truncate",children:n.name}),(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-neon-cyan animate-pulse flex-shrink-0"})]}),(0,a.jsxs)("p",{className:"text-xs text-content-tertiary font-mono mt-0.5 truncate",children:["id:",n.id]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[n.github&&(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[n.github.branch&&(0,a.jsxs)("span",{className:"flex items-center gap-1.5 text-xs text-content-secondary px-2 py-1  bg-surface-tertiary rounded-lg border border-edge-subtle",children:[(0,a.jsx)(m.Z,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,a.jsx)("span",{className:"font-mono truncate max-w-[120px]",children:n.github.branch})]}),(null===(t=n.github.issue)||void 0===t?void 0:t.url)&&(0,a.jsxs)("a",{href:n.github.issue.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-xs text-violet hover:text-violet/80  px-2 py-1 bg-violet/10 rounded-lg border border-violet/20 transition-colors group",children:[(0,a.jsx)(x.Z,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,a.jsxs)("span",{children:["Issue ",n.github.issue.number]}),(0,a.jsx)(D.Z,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"})]}),(null===(s=n.github.pr)||void 0===s?void 0:s.url)&&(0,a.jsxs)("a",{href:n.github.pr.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-xs text-emerald-400 hover:text-emerald-300  px-2 py-1 bg-emerald-400/10 rounded-lg border border-emerald-400/20 transition-colors group",children:[(0,a.jsx)(u.Z,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,a.jsxs)("span",{children:["PR ",n.github.pr.number]}),(0,a.jsx)(D.Z,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"})]})]}),(0,a.jsxs)("span",{className:"text-xs text-content-tertiary px-2 py-1 bg-surface-tertiary rounded-lg border border-edge-subtle",children:[c.length," messages"]})]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-3 md:p-6 min-h-0",children:0===c.length?(0,a.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-sm px-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-2xl bg-gradient-to-br from-surface-secondary to-surface-tertiary  border border-edge-subtle flex items-center justify-center mx-auto mb-4 md:mb-6 shadow-inner-glow",children:(0,a.jsx)(E.Z,{className:"w-7 h-7 md:w-9 md:h-9 text-content-tertiary"})}),(0,a.jsx)("p",{className:"text-content-secondary mb-2 text-sm md:text-base",children:"Start a conversation"}),(0,a.jsx)("p",{className:"text-content-tertiary text-xs md:text-sm",children:"Type a message or use voice input to begin"})]})}):(0,a.jsxs)("div",{className:"space-y-4 md:space-y-6 max-w-4xl mx-auto",children:[c.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2 md:gap-4 message-bubble ".concat("user"===e.role?"flex-row-reverse":""),style:{animationDelay:"".concat(50*t,"ms")},children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-7 h-7 md:w-9 md:h-9 rounded-lg md:rounded-xl flex items-center justify-center\n                  ".concat("user"===e.role?"bg-neon-cyan/20 text-neon-cyan border border-neon-cyan/30":"system"===e.role?"bg-amber/20 text-amber border border-amber/30":"bg-violet/20 text-violet border border-violet/30"),children:"user"===e.role?(0,a.jsx)(_.Z,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}):"system"===e.role?(0,a.jsx)(T.Z,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}):(0,a.jsx)(E.Z,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})}),(0,a.jsxs)("div",{className:"flex-1 max-w-[85%] md:max-w-[80%] ".concat("user"===e.role?"text-right":""),children:[(0,a.jsxs)("div",{className:"inline-block rounded-xl md:rounded-2xl px-3 py-2 md:px-5 md:py-3 text-left text-sm md:text-base\n                      ".concat("user"===e.role?"bg-gradient-to-br from-neon-cyan/20 to-neon-cyan/10 border border-neon-cyan/30 text-content-primary":"system"===e.role?"bg-amber/10 border border-amber/30 text-amber":"bg-surface-elevated border border-edge-subtle text-content-primary"),children:[e.toolCalls&&e.toolCalls.length>0&&(0,a.jsxs)("div",{className:"mb-3 pb-3 border-b border-edge-subtle/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-content-tertiary mb-2",children:[(0,a.jsx)(O.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:["Tool Calls (",e.toolCalls.length,")"]})]}),e.toolCalls.map(e=>(0,a.jsx)(en,{toolCall:e},e.id))]}),e.thoughts&&e.thoughts.length>0&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)(eo,{thoughts:e.thoughts})}),e.plan&&e.plan.length>0&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)(el,{plan:e.plan})}),(0,a.jsx)("div",{className:"prose-sm max-w-none",children:(0,a.jsx)(er,{content:e.content})}),"streaming"===e.status&&(0,a.jsx)("span",{className:"inline-block w-2 h-4 md:h-5 bg-neon-cyan ml-1 typing-cursor"})]}),(0,a.jsxs)("div",{className:"mt-1 md:mt-1.5 flex items-center gap-2 text-[10px] md:text-xs text-content-tertiary ".concat("user"===e.role?"justify-end":""),children:[(0,a.jsx)("span",{children:C(e.timestamp)}),(0,a.jsx)(ea,{text:e.content})]})]})]},e.id)),(0,a.jsx)("div",{ref:y})]})}),(0,a.jsxs)("div",{className:"p-3 md:p-4 border-t border-edge-subtle glass-panel flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2 max-w-4xl mx-auto",children:[(0,a.jsx)(K,{sessionId:n.id}),f&&(0,a.jsxs)("span",{className:"text-xs text-neon-cyan flex items-center gap-1.5",children:[(0,a.jsx)(j.Z,{className:"w-3 h-3 animate-spin"}),"Generating..."]})]}),(0,a.jsxs)("div",{className:"flex items-end gap-2 md:gap-3 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex-1 relative min-w-0",children:[v.isActive&&(0,a.jsx)(et,{suggestions:v.suggestions,selectedIndex:v.selectedIndex,onSelect:S,onHover:v.setSelectedIndex}),(0,a.jsxs)("div",{className:"relative",children:[d.startsWith("/")&&(0,a.jsx)("div",{className:"absolute inset-0 px-3 py-3 md:px-5 md:py-4 pointer-events-none  text-sm md:text-base whitespace-pre-wrap break-words overflow-hidden","aria-hidden":"true",children:(0,a.jsx)(es,{value:d})}),(0,a.jsx)("textarea",{ref:N,value:d,onChange:e=>h(e.target.value),onKeyDown:e=>{if(v.isActive){if("ArrowDown"===e.key){e.preventDefault(),v.selectNext();return}if("ArrowUp"===e.key){e.preventDefault(),v.selectPrev();return}if("Tab"===e.key||"Enter"===e.key&&!e.shiftKey){let t=v.getSelected();if(t){e.preventDefault(),S(t);return}}if("Escape"===e.key){e.preventDefault(),d.startsWith("/")&&h("");return}}"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())},placeholder:"Type a message or / for commands...",rows:1,className:"w-full px-3 py-3 md:px-5 md:py-4 border border-edge-medium rounded-xl md:rounded-2xl \n                           bg-surface-secondary text-sm md:text-base\n                           focus:ring-2 focus:ring-neon-cyan/30 focus:border-neon-cyan/50\n                           placeholder:text-content-tertiary resize-none transition-all\n                           outline-none\n                           ".concat(d.startsWith("/")?"text-transparent caret-content-primary":"text-content-primary"),style:{minHeight:l?"44px":"56px",maxHeight:"150px"}})]})]}),(0,a.jsx)(P,{onTranscription:e=>{h(e)}}),(0,a.jsx)("button",{onClick:k,disabled:!d.trim()||p,className:"p-3 md:p-4 bg-neon-cyan text-surface-primary rounded-xl md:rounded-2xl hover:shadow-glow disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:shadow-none transition-all active:scale-95 flex-shrink-0",children:p?(0,a.jsx)(j.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(F.Z,{className:"w-5 h-5"})})]}),!l&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4 mt-3 text-xs text-content-tertiary",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("kbd",{className:"px-1.5 py-0.5 bg-surface-tertiary border border-edge-subtle rounded text-[10px] font-mono",children:"/"}),"commands"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("kbd",{className:"px-1.5 py-0.5 bg-surface-tertiary border border-edge-subtle rounded text-[10px] font-mono",children:"Enter"}),"to send"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("kbd",{className:"px-1.5 py-0.5 bg-surface-tertiary border border-edge-subtle rounded text-[10px] font-mono",children:"Shift + Enter"}),"for new line"]})]})]})]})}var ei=s(2489),ed=s(2451),em=s(7168),ex=s(5395),eu=s(8293),eh=s(2023);let ep="contextharness_active_session";function eb(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0),[i,d]=(0,r.useState)(null),[m,x]=(0,r.useState)([]),[u,h]=(0,r.useState)(!1),[b,f]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),j=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=()=>{y(window.innerWidth<768),window.innerWidth>=768&&f(!1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let N=(0,r.useCallback)((e,t)=>{let s="toast-".concat(Date.now());x(a=>[...a,{id:s,type:e,message:t}]),setTimeout(()=>{x(e=>e.filter(e=>e.id!==s))},5e3)},[]),v=(0,r.useCallback)(e=>{x(t=>t.filter(t=>t.id!==e))},[]);(0,r.useEffect)(()=>{let t=localStorage.getItem(ep);if(t&&e.length>0){let a=e.find(e=>e.id===t);a&&!s&&n(a)}},[e,s]),(0,r.useEffect)(()=>{s&&localStorage.setItem(ep,s.id)},[s]),(0,r.useEffect)(()=>{let t=t=>{var s,a;if((t.metaKey||t.ctrlKey)&&"n"===t.key&&(t.preventDefault(),h(!0)),(t.metaKey||t.ctrlKey)&&"r"===t.key&&(null===(s=document.activeElement)||void 0===s?void 0:s.tagName)!=="TEXTAREA"&&(null===(a=document.activeElement)||void 0===a?void 0:a.tagName)!=="INPUT"&&(t.preventDefault(),w(),N("info","Refreshing sessions...")),"Escape"===t.key&&(u?h(!1):b&&f(!1)),(t.metaKey||t.ctrlKey)&&t.key>="1"&&t.key<="9"){let s=parseInt(t.key)-1;e[s]&&(t.preventDefault(),n(e[s]),N("info","Switched to ".concat(e[s].name)))}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[u,b,e,N]);let w=async()=>{d(null);try{let e=await fetch("/api/sessions");if(!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));let a=await e.json();if(t(a.sessions),a.sessions.length>0&&!s){let e=localStorage.getItem(ep),t=e?a.sessions.find(t=>t.id===e):null;n(t||a.sessions[0])}}catch(t){let e=t instanceof Error?t.message:"Failed to fetch sessions";d(e),N("error",e)}finally{c(!1)}};(0,r.useEffect)(()=>{w()},[]);let k=async e=>{try{let s=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.detail||"HTTP ".concat(s.status))}let a=await s.json();t(e=>[a,...e]),n(a),h(!1),N("success",'Created session "'.concat(e,'"'))}catch(e){N("error",e instanceof Error?e.message:"Failed to create session")}};return(0,a.jsxs)("div",{className:"flex h-screen bg-surface-primary overflow-hidden",children:[(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-[calc(100vw-2rem)]",children:m.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl shadow-lg animate-in\n              ".concat("error"===e.type?"bg-red-500/90 text-white":"","\n              ").concat("success"===e.type?"bg-emerald-500/90 text-white":"","\n              ").concat("info"===e.type?"bg-surface-elevated border border-edge-subtle text-content-primary":"","\n            "),children:["error"===e.type&&(0,a.jsx)(l.Z,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm truncate",children:e.message}),(0,a.jsx)("button",{onClick:()=>v(e.id),className:"ml-2 opacity-70 hover:opacity-100 transition-opacity flex-shrink-0",children:(0,a.jsx)(ei.Z,{className:"w-4 h-4"})})]},e.id))}),g&&b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 z-30 md:hidden",onClick:()=>f(!1)}),(0,a.jsxs)("aside",{className:"\n        ".concat(g?"fixed inset-y-0 left-0 z-40 w-80 transform transition-transform duration-300 ease-out\n             ".concat(b?"translate-x-0":"-translate-x-full"):"w-80 relative","\n        border-r border-edge-subtle glass-panel flex flex-col bg-surface-primary\n      "),children:[(0,a.jsx)("div",{className:"p-4 md:p-5 border-b border-edge-subtle",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[g&&(0,a.jsx)("button",{onClick:()=>f(!1),className:"p-2 -ml-2 text-content-tertiary hover:text-content-primary  hover:bg-surface-tertiary rounded-lg transition-colors md:hidden",children:(0,a.jsx)(ed.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-neon-cyan/20 to-violet/20  flex items-center justify-center border border-neon-cyan/30",children:(0,a.jsx)($.Z,{className:"w-5 h-5 text-neon-cyan"})}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full shadow-glow-sm\n                ".concat(i?"bg-red-500":"bg-neon-cyan animate-pulse")})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-content-primary truncate",children:"ContextHarness"}),(0,a.jsx)("p",{className:"text-xs text-content-tertiary font-mono",children:"session://manager"})]}),(0,a.jsx)("button",{onClick:()=>{w(),N("info","Refreshing...")},className:"p-2 text-content-tertiary hover:text-content-primary hover:bg-surface-tertiary  rounded-lg transition-colors flex-shrink-0",title:"Refresh sessions (⌘+R)",children:(0,a.jsx)(em.Z,{className:"w-4 h-4 ".concat(o?"animate-spin":"")})})]})}),i&&!o&&(0,a.jsxs)("div",{className:"p-4 m-3 rounded-xl bg-red-500/10 border border-red-500/30",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,a.jsx)(ex.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Connection error"})]}),(0,a.jsx)("p",{className:"text-xs text-content-tertiary mt-1 break-words",children:i}),(0,a.jsx)("button",{onClick:w,className:"mt-2 text-xs text-neon-cyan hover:underline",children:"Try again"})]}),(0,a.jsx)(p,{ref:j,sessions:e,activeSession:s,loading:o,onSelectSession:e=>{n(e),g&&f(!1)},onCreateSession:k,showNewSessionForm:u,onToggleNewSession:h,isMobile:g})]}),(0,a.jsxs)("main",{className:"flex-1 flex flex-col bg-surface-primary min-w-0",children:[g&&(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 border-b border-edge-subtle glass-panel md:hidden",children:[(0,a.jsx)("button",{onClick:()=>f(!0),className:"p-2 text-content-secondary hover:text-content-primary  hover:bg-surface-tertiary rounded-lg transition-colors",children:(0,a.jsx)(eu.Z,{className:"w-5 h-5"})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:s?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-content-primary truncate",children:s.name}),(0,a.jsx)("p",{className:"text-xs text-content-tertiary",children:"Tap menu to switch sessions"})]}):(0,a.jsx)("p",{className:"text-content-secondary",children:"Select a session"})})]}),s?(0,a.jsx)(ec,{session:s,onError:e=>N("error",e),isMobile:g}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,a.jsxs)("div",{className:"relative mb-8 inline-block",children:[(0,a.jsx)("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-2xl bg-gradient-to-br from-surface-secondary to-surface-tertiary  border border-edge-subtle flex items-center justify-center mx-auto shadow-inner-glow",children:(0,a.jsx)(Q.Z,{className:"w-8 h-8 md:w-10 md:h-10 text-content-tertiary"})}),(0,a.jsx)("div",{className:"absolute top-0 right-0 animate-float",children:(0,a.jsx)(eh.Z,{className:"w-4 h-4 md:w-5 md:h-5 text-neon-cyan opacity-60"})})]}),(0,a.jsx)("h2",{className:"text-xl md:text-2xl font-semibold text-content-primary mb-3",children:"No Session Selected"}),(0,a.jsx)("p",{className:"text-content-secondary leading-relaxed text-sm md:text-base",children:g?"Tap the menu to select or create a session":"Select a session from the sidebar or create a new one to start working"}),!g&&(0,a.jsxs)("div",{className:"mt-8 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-content-tertiary text-sm",children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-surface-tertiary border border-edge-subtle rounded text-xs font-mono",children:"⌘"}),(0,a.jsx)("span",{children:"+"}),(0,a.jsx)("kbd",{className:"px-2 py-1 bg-surface-tertiary border border-edge-subtle rounded text-xs font-mono",children:"N"}),(0,a.jsx)("span",{className:"ml-2",children:"New session"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-content-tertiary text-sm",children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-surface-tertiary border border-edge-subtle rounded text-xs font-mono",children:"⌘"}),(0,a.jsx)("span",{children:"+"}),(0,a.jsx)("kbd",{className:"px-2 py-1 bg-surface-tertiary border border-edge-subtle rounded text-xs font-mono",children:"1-9"}),(0,a.jsx)("span",{className:"ml-2",children:"Quick switch"})]})]}),g&&(0,a.jsx)("button",{onClick:()=>f(!0),className:"mt-6 px-6 py-3 bg-neon-cyan text-surface-primary rounded-xl font-semibold hover:shadow-glow transition-all active:scale-95",children:"Open Sessions"})]})})]})]})}}},function(e){e.O(0,[898,971,117,744],function(){return e(e.s=3883)}),_N_E=e.O()}]);